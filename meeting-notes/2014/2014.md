# 9/3/14

## Repository
- bitbucket
- development forks (todo)
- documentation
- CMake build system

## Wiki
- markdown format

## Staffing
- Patrick Widener is SNL staff developer on the project (added to mailing list)
- I posted an ANL postdoc position and am skyping one candidate from Austria on Monday

## Scope, technical topics, first steps (in no particular order)
- Develop pipeliner primitive.
- Demonstrate HACC->tess->dense in decaf
- Buffer mismatched data rates, develop buffer primitive
- Develop data description layer
- Develop soft error detection
- Start designing base classes (Tom)
- Understand existing tools and their possibility for reuse, in particular the MxN nature of those tools (Jay)
- Meet and understand relationship between DIY datatypes and file views (Tom, Florin)
- View approach for collectives for MPICH; data staging using double buffering; view, buffering, collective I/O based on views (Florin)

## Platform, tools:
- I will start with prototypes in MPI and DIY, using separate communicators to emulate different jobs
- Jay will work in C/C++ and Nessie (hidden from user)
- Florin in C

## Upcoming:
- I will miss the next meeting
- Florin to take paternity leave any time now

-----------------------

# 10/1/14

## Tom: Personnel update
- Guillaume Aupy, postdoc working on resilience modeling
- Lokman Rahmani, student starting next week and staying at ANL for 3 months, background in Damaris
- Skyping postdoc candidate next week

## Tom: Software update
- Decaf wrappers around transport layer implementations of datatype and communicator
- I'm working in a partition of a single application and world communicator into producer, dataflow, and consumer ranks, and forming of producer-dataflow and dataflow-consumer communicators
- Dataflow is an intermediate area between producer and consumer. Data moves in 2 steps producer->dataflow and dataflow->consumer.
- Selection / aggregation is also a 2-step process: prod_selector and con_selector functions are defined by the user and they filter everything going into and out of the dataflow.
- example of usage in examples/direct.cpp
- documentation contains notes on the above items
- code contains the details
- next up: pipelining

## Jay: Trilinos
- provides transport layer abstractions as well
- will evaluate whether we can use them and report back

## Jay: GT's EVPath
- For coupling separate independent applications
- Should be about 70% of the way there for what we need

## Jay: applications
- In a couple of weeks there will be a Hobbes code-athon; will have real examples of simulations there.

## Fault tolerance:
- Jay: reminiscent of transactions project. How do you know that you haven't lost anything, no errors occurred?
- Franck: another next step can be to define the criticality of data in the data model.

## Next Meeting: October 15
- Tom will be on travel, will try to call in.

-----------------------

# 10/15/14

## Tom:
No new code this week, but several thoughts about software organization to work on in upcoming weeks.

- Flexibly assign disjoint or overlapping nodes for producer, consumer, dataflow.
- Having the user need to define two selector functions may be awkward. The user is not thinking in terms of the dataflow, and it should be as transparent as possible. Having a selector for the producer and one for the dataflow is hard to understand. Perhaps it makes more sense having the con_selector function be actually in the consumer space, and presenting a producer and consumer pair of selector functions to the user.
- We may want to have a wrapper around the low-level datatypes that map to higher level data models such as meshes, graphs, etc. Users don't think in terms of datatypes; they think in terms of vertices, cells, nodes, edges, etc., ie. data objects that make sense in terms of the application. (TODO: Lokman)
- Investigate using DIY communication patterns to execute the aggregation/selection in a tree instead of point to point
- Need bidirectional dataflow for steering the consumer.
- I need to understand whether and how asynchronous pub/sub can be another implementation for put/get?

## Florin
Four main areas of work.

1. Data distributions primitives based on MPI datatypes.

- In memory and in file
- Redistribution

2. MPI data access primitives

- Collectives and noncollectives
- Based on data distribution primitives

3. Decoupled version of MPI accesses

- AHPIOS

4. Data staging methods

- 2 layer buffering

Investigating how could we use these tools in order to implement the four primitives, including incoming, outgoing request queues in dataflow layer. Items 1, 2 are basically done. Items 3, 4 are next steps.

Tom to meet with Florin early next week.

## Jay and Patrick

- Continuing to investigate EVPath from GT
- Working with Jai Dayal, one of Karsten's students
- Will look next week at the Hobbes code-athon with Jai how to get untyped raw streams
- EVPath: strongly typed in data streams, but there is a way to get untyped raw streams
    - In your code define some datatypes on both ends of connection independently
    - Set up a subscription relationship based on type matching
    - NNTI layer as bottom layer (MPI, Gemini, TCP/IP, others)
    - Set up stones (stepping stones), dynamically compiled C code
- Defining the global flow overall:
    - How to describe our needs wrt workflow tool
- Applications
    - Hobbes 3 canonical workflows
        - Jay will get information
        - GTCP fusion, 200 MB per process per output step (probably closed code)
        - SNAP (probably open)
        - one other (hopefully open)?

## Lokman

High-level data models based on Damaris background:

- XML description of data model
- XML parser to generate raw data type
- Plugin system to add analysis functions
    - Plugins were local, but recently the ability was added to communicate among plugin nodes
- Preparing small example with Damaris and plugins for analysis tasks
- Choose automatically which nodes will be of which type

Suggestions for work based on example source code:

- Developer API (existing) and user API (friendly wrapper)
    - User API to provide abstract classes for datatypes, communication, resource allocation

- TODO: Define use cases
    - Tom and Lokman to meet and work on this

## Guillaume

Resilience in a layer on top of the dataflow

Build a model of the decaf dataflow with different parameters

Objectives:

- Synthesize a resilient dataflow
- Optimize node replication for resilience
- Compare replication with checkpointing
- Model communication costs, influence of replication

## Hadrian

Background:

- Just completed MS at INRIA
- Will start PhD next year
- Worked with Grid RPC team to perform RPC calls with different middleware

Several technical questions with the code:

- couldn't compile
- Lokman will help
- Tom to meet with Hadrian later this week

## Upcoming Schedule:
- Next meeting: 10/29/15, Guillaume will be unavailable
- PI meeting: tentatively 1/13/15 - 1/15/15 in the Berkeley area

-----------------------

# 10/29/15

## Tom

- Solved how to embed images in .md files: use absolute URL and insert /raw/master after decaf, like this:
```
![Decaf communicators](https://bitbucket.org/tpeterka1/decaf/raw/master/doc/comms.png)
```
- Switch bitbucket to private and assign individual permissions? Not at this time.
- Added overlapping communicators
- Selectors: removed selector in dataflow leaving only selector in producer; selector will only do slection, not aggregation; planning for automatic aggregation (See doc/select.md).
- Data model: plan for defining datatype in terms of a vector of unit types that can be distributed automatically (See doc/data.md).

## Jay

- Recent Hobbes code-athon
- 3 workflow examples that are either full applications or proxy apps connected to some analysis routine
- SNAP proxy (on github)
- GTC proxy (allowed to redistribute as long as original authors are notified, semiprivate)
- LAMMPS full MD code (public)

## Patrick

- Looking at GT EVPath software
- Resurrecting old code from previous projects
- There is a paper from cluster computing about data layout, open metadata format, will add to wiki
- EVPath has a layer on top of communication layer to do dataflow layout (DAG?), will investigate

## Hadrien, Franck

- Reproduced HACC -> density estimation pipeline from cosmology
- Wrote scripts to compile HACC
- Will try to set up a phone call with Slim, need access to his previous work, Tom will follow up with Franck
- Working out density estimator artifacts with Tom

## Florin

- Writing a library to couple _n_ parallel processes to _m_ servers
- Bidirectional capability
- One implementation: everything coupled together in same MPI communicator
- Other implementation: separate applications
    - producer spawns MPI processes
    - uses MPI connect - accept
    - uses MPI intercommunicators
    - eventually want to abstract in decaf, analagous to the way I abstracted communicator creation

## Lokman

- High-level interface for communicator formation (splitting, spawining)
- Defined in XML file
- Thinking about how to communicate with workflow
- Thinking about abstract data description layer

## Upcoming

- Next meeting 11/12
- Jay, Patrick, Lokman, Tom (Guillaume?) to schedule chatting in person at SC
