\documentclass[10pt,a4paper,twoside,twocolumn]{article}
\input{../Annexes/ReportPackages.tex}

\newcommand*{\rootPath}{../}
\standalonetrue

\begin{document}

\section{Density estimation methods}

Several methods exist to perform density estimation. Those methodes give result
with different level of quality for different computational cost. This section
will focus on describing some of those methods, which represent different
compromise.

\subsection{Methods description}

\subsubsection{CIC}

CIC\cite{Birdsall_Fuss_1969} (Cloud in cell) is the simpler and cheapest of all
methods presented in this paper. 

This method simply distribute each sample weight among the closest grid points.
This method has a very low computational cost ($\mathcal O(n)$) but suffer from
a very low quality in parse areas where each sample should be distributed over a
larger area, resulting in a lot of noise.

\subsubsection{AKDE}

AKDE\cite{Rosenblatt}\cite{Parzen1962} (Adaptive Kernel Density Estimator)
methods are the natural variant of CIC.

To try and solve the high quantity of noise, Kernel Density Estimator uses large
windows over which they distribute the weight of each sample. Those weight
follow a kernel function, typically gaussian function.

In order to avoid noise in parse areas and oversmoothing in dense areas, the
windows sizes are follow the local density. Windows adaptation criterions have
been extensivelly studied\cite{Heidenreich2013} but can, in some cases,
dramatically increass the computational cost.

Our implementation uses a kd-tree construction for selecting the window sizes.
Overall the complexity is $\mathcal O(n\log n + g^3)$ with far better results
then CIC (cf~\ref{ssect:method-results}).

\subsubsection{SPH}

\todo{to write}... %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TODO

\subsubsection{Tess-Dense}

Unlike all previous algorithm, Tess-Dense doesn't use fixed shape windows.
Indeed, Tess-Dense uses a voronoï tesselation to determine each sample influence
domaine\todo{ref}. This precomputation is independant of the result grid's
resolution therefore reducing the memory footprint on high resolution
reconstruction. This cost is however paid even for small resolutions.

The cost of this method is $\mathcal O(n^2 + g^3)$, with results suffering from
some noise. This noise comes from the NGP\todo{ref} (Nearest Grid Point)
approche when voronoï cells are to small to include any grid point (high local
density) which can be reduced by using CIC in such cases and by geometric
instability of voronoï cells in sparse areas.

\subsection{Methods results} \label{ssect:method-results}

To compare thoses different methods results we plot the frequencial reponse of
their result and compare them to the analytical result. One should not forget
that the input set of those methods are sampling of a density function. As those
sampling are inherently random, we cannot just observe on sampling and the
associated result.

In order to take this randomness into account we computed several samplings of
our density function model and then display both the median of the frequencial
results overs thoses samplings as well as extreme values. That way we can not
only describe the expected quality of those methods but also the natural
variability we can expect. Figure~\ref{fig:spectral} present thoses results for
all prevously described methods.

\begin{figure}[!ht]
	\centering
	\includegraphics[width=0.24\textwidth]
		{\rootPath Figures/cnfw_particles_2e5_cic_clamped.pdf}
	\includegraphics[width=0.24\textwidth]
		{\rootPath Figures/cnfw_particles_2e5_akde_clamped.pdf}
	\includegraphics[width=0.24\textwidth]
		{\rootPath Figures/cnfw_particles_2e5_sph_clamped.pdf}
	\includegraphics[width=0.24\textwidth]
		{\rootPath Figures/cnfw_particles_2e5_tesscic_clamped.pdf}
	\includegraphics[width=0.48\textwidth]
		{\rootPath Figures/cnfw_particles_2e5_full.pdf}
	\caption{Spectral analysis of density estimation methods}
	\label{fig:spectral}
\end{figure}

Thoses results clearly shows the noisiness of CIC. As for the other methods,
they give different shape of results with different level of variability while
not showing one as clearly better than the others.

Tess-Dense's slight noisiness might be related to the use of flat weight
distribution among each cell's inner grid point. Secondary methods used for
weight distribution in dense area are also subject to some aliasing and
therefore noise.

On the AKDE/SPH side, we mostly notice a high intrinsic variability. That may be
caused by the sampling's random variation affecting the window size computation
in such a way that we could locally encounter noisyness or oversmoothness.

%=====================================================================
%=====================================================================
\ifstandalone
	\bibliographystyle{apalike}
	\bibliography{\rootPath Annexes/biblio}
\fi
%=====================================================================
%=====================================================================
\end{document}
